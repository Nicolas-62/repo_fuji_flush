#{extends 'main.html' /}
#{set title:'Saloon' /}

<nav class="navigation">
    <a href="/ranking" class="navigation-item"> CLASSEMENT </a>
    <a href="/history" class="navigation-item"> HISTORIQUE </a>
    <a href="@{Application.saloon()}" class="navigation-item">Mon Saloon</a>
</nav>
<form action="@{Application.addGame()}" method="post">
    <input list="nbPlayer" name="nbPlayer">
    <datalist id="nbPlayer">
        <option value="3">
        <option value="4">
        <option value="5">
        <option value="6">
        <option value="7">
        <option value="8">
    </datalist>
    <input type="submit" value="CrÃ©er partie">

</form>
<ul>
#{if games}
    #{list items:games, as:'aGame'}
        #{if aGame.winner != null}
        <li>Game <a href="#">revoir</a></li>  
        #{/if}  
        #{else}
            #{set join:true/}
            #{list items:aGame.hands, as:'aHand'}
                #{if aHand.player.equals(player)}
                    #{set join:false/}
                    #{if aGame.nbPlayerMissing == 0}
                        <li>Game : <a href="@{Application.play(aGame.id)}">jouer</a></li>
                    #{/if}
                    #{else}
                        <li>Game : en attente des autres joueurs</li>
                    #{/else}
                #{/if}
            #{/list}
            #{if join}
                #{if aGame.nbPlayerMissing == 0}
                    <li>Game : complet</li>
                #{/if}
                #{else}
                <li>Game : <a href="@{Application.joinGame(aGame.id)}">rejoindre</a></li>
                #{/else}
            #{/if}
        #{/else}
    #{/list}      
#{/if}
</ul>
